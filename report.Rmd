---
title: "Final Report"
output: 
  html_document:
    code_folding: hide
    toc: true
    toc_float: true
editor_options: 
  chunk_output_type: console
---

# Motivation

The practice of redlining, where certain neighborhoods were systematically denied access to resources based on racial and economic factors, has had long-lasting effects on urban communities. In New York City, the legacy of redlining continues to shape access to vital services such as healthy food and public assistance programs. The motivation for this project is to explore how these historical practices have impacted modern-day disparities in access to healthy grocery stores and enrollment in the Supplemental Nutrition Assistance Program (SNAP).

Our primary goal is to investigate the relationship between the neighborhoods that were historically redlined and their current access to essential resources. We seek to answer questions about the extent to which redlining has contributed to food deserts, areas where healthy food options are scarce, and whether these communities have disproportionately higher rates of SNAP enrollment. By understanding these connections, we aim to uncover the ways in which systemic inequalities persist in shaping the health and well-being of New Yorkers, and to contribute to ongoing discussions about potential policy solutions to address these disparities.

This project is driven by a desire to shed light on the intersection of urban planning, socioeconomic disparities, and public health, and to highlight the role of policy in creating both opportunities and barriers for communities that continue to experience the effects of redlining. Through this exploration, we hope to contribute valuable insights to the broader conversation about equity in urban environments and the long-term impacts of discriminatory practices on marginalized populations.

# Initial Questions

- **Neighborhood:** What areas in NYC were most heavily impacted by redlining? How do the demograpics within these areas compare?
- **Grocery:** Are there fewer healthy grocery stores in neighborhoods that were historically redlined compared to other areas? How does access to health grocery stores correlate with health outcomes in these neighborhoods?
- **SNAP:** Is there a higher rate of SNAP enrollment in areas that were historically redlined? Do these areas face more challenges accessing SNAP benefits? 
- **Analysis:**
  - How does redlining classification (e.g., grade A, B, C, D) predict the proportion of households enrolled in SNAP at the census tract level?
  - Is redlining associated with food insecurity related health outcomes(diabetes, obesity and high cholesterol level)?

# Data

## Data Sources 

### SNAP enrollment data:

The SNAP enrollment data was acquired from the American Community Survey 5-year estimates of 2022 from the Census Bureau. The original dataset contained estimates for SNAP/Food stamp enrollment at the census tract level as well as other households attributes at the census tract level: estimate and percent for distribution of race and ethnicity, poverty status, disability status, presentation of children under age of 18, etc.

We selected the variables that were relevant to our analysis to build the final dataset, the final variables included were the following:
  
  - ` r geoid`: the geographic id for identification of census tract 
  - `total_ct_households`: estimate total count for number of households 
  - `ph_with_children`: estimate percentage of households with children under 18 years
  - `ph_no_children`: estimate percentage of households without children under 18 years 
  - `ph_below_poverty`:estimate percentage of households below poverty level in the past 12 months
  - `ph_above_poverty`: estimate percentage of households at or above poverty level in the past 12 months
  - `ph_disability`: estimate percentage of households with one or more people with disability 
  - `ph_no_disability`: estimate percentage of households with no person with disability 
  - `ph_white`: estimate percent households race and Hispanic or Latino origin of householder, White alone
  - `ph_black`: estimate percent households race and Hispanic or Latino origin of householder, Black or African American alone
  - `ph_asian`: estimate percent households race and Hispanic or Latino origin of householder, Asian alone
  - `ph_other race`: estimate percent households race and Hispanic or Latino origin of householder, other races (derived from the estimate value for White, Black and Asian race groups)
  - `ph_hispanic`: estimate percent households race and Hispanic or Latino origin of householder, Hispanic or Latino origin of any race
  - `ph_non_hispanic`: estimate percent households race and Hispanic or Latino origin of householder, not of Hispanic or Latino origin of any race  (derived from the estimate value for Hispanic or Latino origin of any race)
  - `ph_no_work`:estimate percent of families with no workers in past 12 months 
  - `ph_1_work`: estimate percent of families with 1 worker in past 12 months 
  - `ph_2_work`: estimate percent of families with 2 or more workers in past 12 months 
  - `ph_snap`: estimate percent of households receiving SNAP/Food Stamp 

### Historic Redlining Score Data

The historic redlining score(HRS) (`hrs2020`) was obtained from the calculation by the National Community Reinvestment Coalition(NCRC). It was a weighted score calculated based on the percentage of the area within each 2020 census tract according to HOLC grades. HRS ranged from 1-4, the higher the score indicated a greater level of historical redlining. The detailed method for calculating the HRS was indicated in the figure below. The hrs data was divided into quartiles and the division of quartiles is indicated by the `interval2020` variable. The more detailed methodology regarding coding for redlining grades can be found [here](https://ncrc.org/holc-health/#methods).

We filtered based on the geoid to only keep the data for the census tracts within NYC based on the fipcodes for NYC counties. We recoded the census tracts with HOLC grades according to hrs. A (hrs: 1~1.5) defined as "Best", B (hrs: 1.5~2.5) defined as "Still Desirable", C (hrs: 2.5~3.5) defined as "Definitely Declining” and D(hrs > 3.5) defined as "Hazardous”.

## Recognized Healthy Store in NYC 

We obtained a data regarding recognized healthy store from the NYC Department of Health and Mental Hygiene. This dataset contained 675 bodegas & grocery stores receiving recognition from Borough President's Office regarding providing healthy food choices to its customers. The original dataset contained variables describing basic information of the stores(`name`,`store identifier`), geographic location(`address`, `census tract`, `zip code`, `borough`, `longitude` and `latitude`), year awarded and the program wave. 

## PLACE data 

We also extracted the PLACES: Local Data for Better Health, 2024 release for NYC census tracts from CDC to obtain the prevalence of a variety of health indicators that are likely associated with food insecurity: `diabetes`, `obesity` and `high cholesterol`. 

## Data Cleaning

```{r overall_setup, message=FALSE}
knitr::opts_chunk$set(message = FALSE, warning = FALSE)
library(tidyverse)
library(readxl)
library(ggplot2)
library(dplyr)
library(plotly)
library(stringr)
```

### Cleaning SNAP data set: 

```{r}
SNAP = 
  read_csv(file = "./Datasets/ACS_SNAP_ENROLLMENT.csv")|>
  janitor::clean_names()|>
  select(
    geo_id:s2201_c01_001e,
    s2201_c02_009e,
    s2201_c02_015e,
    s2201_c02_021e:s2201_c02_028e,
    s2201_c02_032e,
    s2201_c02_036e:s2201_c02_038e,
    s2201_c04_001e)|>
  select(-ends_with("m"))|>
  slice(-1)|>
  mutate(geoid = str_remove(geo_id, ".*US"))|>
  rename(
     total_ct_households = s2201_c01_001e,
     ph_with_children = s2201_c02_009e,
     ph_no_children = s2201_c02_015e,
     ph_below_poverty = s2201_c02_021e,
     ph_above_poverty = s2201_c02_022e,
     ph_disability = s2201_c02_023e,
     ph_no_disability = s2201_c02_024e,
     ph_white = s2201_c02_025e,
     ph_black = s2201_c02_026e,
     ph_asian = s2201_c02_028e,
     ph_hispanic = s2201_c02_032e,
     ph_no_work = s2201_c02_036e,
     ph_1_work = s2201_c02_037e,
     ph_2_work = s2201_c02_038e,
     ph_snap = s2201_c04_001e
  )|>
  mutate(across(total_ct_households:ph_snap, as.numeric),
         ph_other_race = 100-ph_white-ph_black-ph_asian,
         ph_non_hispanic = 100-ph_hispanic)|>
  select(geoid,name,ph_snap,everything())|>
  select(-geo_id)
```

The window below is a preview of the SNAP data set. 

```{r}
head(SNAP)|>
  knitr::kable()|>
  kableExtra::kable_styling(bootstrap_options = c("striped", "hover"), font_size = 12) %>% 
  kableExtra::scroll_box(width = "100%", height = "300px")
```

### Redlining dataset cleaning:

```{r}
redlining = 
  read_excel("./Datasets/Historic Redlining Score 2020B.xlsx")|>
  janitor::clean_names()|>
  select(-cbsa)|>
  mutate(fip = substr(geoid20, 1, 5),
         interval2020 = as.character(interval2020),
         red_grade = case_when(
           hrs2020 < 1.5 ~ "A",
           hrs2020 < 2.5 ~ "B",
           hrs2020 < 3.5 ~ "C",
           TRUE ~ "D"
         ))|>
  filter(fip %in% c("36005", "36047", "36061", "36081", "36085"))|>
  rename(geoid = geoid20)
```

We subsequently match the historic redlining score with snap enrollment data and our analysis based on geoid for the census tracts. 18 census tracts were removed for the final analysis due to missing value for snap enrollment data. Our final dataset contained 2034 observations and 25 variables. 

```{r}
redlining_snap = 
  redlining|>
  left_join(SNAP, by = "geoid")|>
  filter(is.na(ph_snap)==FALSE)

redlining_snap|>
  knitr::kable()|>
  kableExtra::kable_styling(bootstrap_options = c("striped", "hover"), font_size = 12) %>% 
  kableExtra::scroll_box(width = "100%", height = "300px")
```

### Health stores data set cleaning:

```{r}
nyc_healthy_store = 
  read_csv("./Datasets/Recognized_Shop_Healthy_Stores.csv")|>
  janitor::clean_names()|>
  distinct(bin, .keep_all = TRUE)|>
  mutate(fipcode = case_when(
    borough == "Bronx" ~ "36005",
    borough == "Brooklyn" ~ "36047",
    borough == "New York" ~ "36061"
  ),
  ct_label = case_when(
    census_tract_2020 < 100 ~ paste0("00", census_tract_2020, "00"),
    census_tract_2020 < 1000 ~ paste0("0", census_tract_2020, "00"),
    census_tract_2020 < 1200 ~ paste0(census_tract_2020, "00"),
    census_tract_2020 < 10000 ~ paste0("00", census_tract_2020),
    census_tract_2020 < 100000 ~ paste0("0", census_tract_2020)
  ))|>
  select(store_name,borough,zip_code,latitude,longitude,fipcode, ct_label)|>
  filter(!is.na(ct_label))|>
  mutate(geoid = paste(fipcode, ct_label, sep = ""))|>
  select(-fipcode, -ct_label)

head(nyc_healthy_store)|>
  knitr::kable()|>
  kableExtra::kable_styling(bootstrap_options = c("striped", "hover"), font_size = 12) %>% 
  kableExtra::scroll_box(width = "100%", height = "300px")
```

The data only had stores from the Bronx, Brooklyn and New York County. We coded the geoid for the census tracts based on the fipcode of NYC, boroughs and specific census tract codes. Stores that does not provide the census tract level data were excluded.Eventually, we selected the variables that were relevant for our exploratory and statistical analysis. The variables included involve: `r names(nyc_healthy_store)`.

We obtain the count for the number of healthy food stores within each census tracts and matched that with the snap enrollment data for New York City, Bronx and Brooklyn Borough based on geoid.  

```{r}
health_store_count = 
nyc_healthy_store|>
  group_by(geoid)|>
  summarise(count_healthy_stores=n())

#please note that healthy store count is only available in three boroughs so make sure you filter before the match
#example code for the match

redlining_snap|>
  filter(str_starts(geoid, "36005") | str_starts(geoid, "36047")| str_starts(geoid, "36061"))|>
  left_join(health_store_count,by="geoid")
```

### PLACE data 

For the purpose of matching with other data sets, we pivoted the original data set into wide format to obtain the health measures as columns and rows as each census tracts. 

```{r}
place_crude =
  read_csv("./Datasets/PLACES.csv")|>
  janitor::clean_names()|>
  rename(geoid = location_id)|>
  select(geoid, measure:data_value, measure_id)


place_cleaned=
  place_crude|>
  filter(measure_id %in% c("DIABETES", "HIGHCHOL", "OBESITY"))|>
  pivot_wider(
    id_cols = geoid,
    names_from = measure_id,
    values_from = data_value
  )|>
  janitor::clean_names()|>
  mutate(geoid = as.character(geoid))

head(place_cleaned)|>
  knitr::kable()|>
  kableExtra::kable_styling(bootstrap_options = c("striped", "hover"), font_size = 12) %>% 
  kableExtra::scroll_box(width = "100%", height = "300px")
```

The description regarding the health indicators we have used for the analysis were indicated in the table below. 

```{r}
place_crude|>
  distinct(measure, data_value_unit, measure_id)|>
  filter(measure_id %in% c("DIABETES", "HIGHCHOL", "OBESITY"))|>
  knitr::kable()
```

# Exploratory Analysis

## Visualizations

# Regression Analysis

# Discussion

Our analysis found that redlining is significantly associated with food insecurity in New York City at the census tract level. This finding indicates that historic housing policies affected households' food security and relevant health outcomes in New York City. Households residing in neighborhoods that were graded as declining or hazardous were more likely to have limited access to adequate food compared to households residing in neighborhoods that were graded as desirable by HOLC.

Discriminatory housing policies like redlining have created structural inequalities that have had a significant influence on people's health, and racial minorities and people with low socio-economic status were disproportionately affected. Redlined neighborhoods also had a higher proportion of racial minorities, households with people with disabilities, and households living under the poverty line. Redlined neighborhoods had a higher prevalence of obesity compared to neighborhoods that were classified as desirable. However, diabetes was not found to be associated with historical redlining. Redlined neighborhoods were also found to have a significantly lower prevalence of high cholesterol levels compared to neighborhoods that were classified as desirable. Future research should focus on understanding the complex relationships between historical policies, food access, and relevant health outcomes. These findings imply that policy interventions need to target redlined neighborhoods with increased resources and support to address food insecurity and related health disparities, such as higher rates of obesity.

The strength of our project was that we utilized data from multiple sources to explore the association between redlining and food insecurity. We explored the issue from both a socio-economic and health perspective using visualization and statistical analysis. One of the limitations of our analysis would be that the percentage of households enrolled in SNAP is highly right-skewed and thus may affect the homoscedasticity of the model. We were able to address that by performing a log transformation to increase the robustness of our model. 

The significant association between historical redlining and food insecurity in New York City suggests that discriminatory housing policies continue to have lasting effects on health outcomes. The higher prevalence of racial minorities, households with people with disabilities, and low-income families in redlined areas highlights the compounded impact of systemic inequities. Efforts to improve food access and reduce health disparities should therefore include targeted strategies aimed at these vulnerable populations. Public health initiatives might also need to involve urban planners, community organizations, and local governments to dismantle the structural barriers formed by redlining.




Our project also explored the relationship between redlining grades and three health outcomes: diabetes, high cholesterol, and obesity. The results from the regression models for each health outcome indicate a statistically significant relationship, reinforcing the idea that redlining continues to have a profound impact on public health. The findings suggest that individuals living in areas with worse redlining grades (C and D) are at a higher risk for certain health conditions

In the univariable obesity model, the relationship between redlining and obesity outcomes is more directly significant. The intercept of 20.736 (p < 0.001) provides the baseline obesity rate for individuals in grade A areas. For grade B, grade C, and grade D, the estimates were 5.187, 6.770, and 7.974, respectively (all with p < 0.001). These results showed that as the redlining grade worsens, obesity prevalence increases. This finding aligns with previous research suggesting that neighborhoods with poorer infrastructure, limited access to healthy food, and reduced access to healthcare services may exacerbate obesity rates. The statistically significant p-values for all grades further support that redlining has a substantial effect on obesity outcomes.

In the univariable diabetes model, the results indicate a similar trend, with redlining grades playing a significant role. The intercept for grade A was 9.247 (p < 0.001), while the estimates for grade B, grade C, and grade D were 1.866, 3.108, and 2.337, respectively. While the relationship is positive, it is less pronounced than for obesity. The coefficients show a gradual increase in diabetes levels as the redlining grade worsens, and the p-values for all estimates were statistically significant (p < 0.05), further solidifying the link between redlining and diabetes.

The results from the univariable high cholesterol model showed a clear relationship between redlining grades and high cholesterol. Specifically, individuals from areas with worse redlining grades (e.g., grades C and D) are more likely to have higher high cholesterol outcomes. The intercept of 37.275 (p < 0.001) indicates a baseline level of high cholesterol for individuals in grade A areas. However, when moving to B, C, and D, the estimated effects were negative, with estimates of -2.775, -3.133, and -4.989, respectively, all with p-values less than 0.001. This trend suggests that, contrary to what might be expected, individuals from higher redlining grades may have lower high cholesterol scores, potentially due to systemic barriers and less access to health resources that prevent the management of high cholesterol.

Thus, we extended analysis and performed multivariable regression models that adjusted for additional covariates, including race (ph_white, ph_black, ph_asian), age (ph_elderly), disability (ph_disability), and employment status (ph_no_work). The goal of these models was to assess whether the relationships observed between redlining grades and health outcomes would hold after accounting for these important socio-demographic factors.

After adjusting for other socioeconomic factors, the redlining grades did not show statistically significant effects in this model, particularly for grades B, C, and D. Race and disability were significant predictors of the outcome, with white individuals showing a negative relationship with the outcome and black and asian individuals also showing significant negative associations.
Being elderly, having a disability, or being unemployed were significantly associated with higher outcomes, suggesting that these socio-demographic factors play a critical role in the health disparity seen in redlined areas.

The relationship between redlining grades and diabetes is robust, even after controlling for race, age, disability, and employment status. This indicated that redlining has a direct and significant impact on the prevalence of diabetes, likely due to limited access to healthcare, healthy food, and physical activity resources in redlined areas.

For high cholesterol, redlining continued to show a negative relationship, but the effect size is smaller than for diabetes. The adjusted model indicated that race and socioeconomic status are crucial in understanding how redlining impacts health outcomes.

Our findings indicated that redlining continues to have a direct and significant influence on diabetes outcomes, even after controlling for other socioeconomic factors, emphasizing that limited access to healthcare, nutritious food, and physical activity resources in these areas contributes to higher diabetes rates. Conversely, the relationship between redlining and high cholesterol is weaker, but still significant, highlighting the broader health disparities faced by residents in redlined communities. While the effect of redlining grades on obesity diminished after adjusting for socioeconomic factors, other important predictors, such as race and disability, remain significant, demonstrating the complexity of health outcomes in redlined areas. Specifically, individuals who are elderly, disabled, or unemployed were found to have higher levels of the outcome, reinforcing the role of social determinants in shaping health.

These results emphasized the need for targeted interventions that address not only the historical and structural impacts of redlining, but also the broader socioeconomic factors that perpetuate health disparities.
